# 函数

```{mermaid}
mindmap
Function
    Declaration
    Arguments
      Default arguments
      Variadic arguments
    Lambda expression
    Overload
```

## 函数重载

Note: There are many more rules and exceptions to the following rules.

### 基本步骤

A named function can be processed in the following way:
- The name is looked up to form an initial overload set.
- If necessary, this set is adjusted in various ways e.g.
  - template argument deduction and substitution occurs
- Any candidate that doesn’t match the call at all is eliminated from the overload set. This
results in a set of viable function candidates.
- Overload resolution is performed to find a best candidate. If there is one, it is selected; otherwise, the call is ambiguous.
- The selected candidate is checked. For example:
  - if it is a deleted function
  - if it is an inaccessible private member function

### Best Match

For one candidate to be considered better than another, the better candidate cannot have any of its parameters be a worse match than the corresponding parameter in
the other candidate.

As a first approximation, we can rank the possible matches as follows (from best to
worst):
- Perfect match, including
  - a reference to the type
- Match with minor adjustments, e.g.
  - decay of an array variable
  - addition of const
- Match with promotion
- Match with standard conversions only, e.g.
  - standard conversion (such as int to float)
  - conversion from a derived class to one of its public, unambiguous base classes
- Match with user-defined conversions
- Match with ellipsis (`...`)

```cpp
void report(int); // #1
void report(int&); // #2
void report(int const&); // #3

int main()
{
for (int k = 0; k<10; ++k) {
  report(k); // ambiguous: #1 and #2 match equally well
}
report(42); // ambiguous: #1 and #3 match equally well
}
```